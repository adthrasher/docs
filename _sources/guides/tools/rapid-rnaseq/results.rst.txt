Analysis of Results
===================

The complete output file specification is listed on the 
Rapid RNA-Seq :ref:`rapid-rnaseq-overview` page. Here, we will
discuss the different output files and how you can use them.

Raw Result Files
----------------

* **Predicted gene fusions**: The predicted gene fusions will be output
  with the filename :code:`SAMPLE.final_fusions.txt`. This file is a tab-delimited
  file containing many fields for each of the predicted SV. The most important
  columns are the following.

  +----------------------+----------------------------------------+
  | Field Name           | Description                            |
  +======================+========================================+
  | :code:`sample`       | Sample name                            |
  +----------------------+----------------------------------------+
  | :code:`gene*`        | Gene name                              |
  +----------------------+----------------------------------------+
  | :code:`chr*`         | Chromosome name                        |
  +----------------------+----------------------------------------+
  | :code:`pos*`         | Genomic Locaton                        |
  +----------------------+----------------------------------------+
  | :code:`ort*`         | Strand                                 |
  +----------------------+----------------------------------------+
  | :code:`reads*`       | Supporting reads                       |
  +----------------------+----------------------------------------+
  | :code:`medal`        | Estimated pathogenicity assessment     |
  +----------------------+----------------------------------------+

* **Coverage file**: A standard `bigWig <https://genome.ucsc.edu/goldenpath/help/bigWig.html>`_ file 
  used to describe genomic coverage data.
* **Splice junction read counts**: A custom file format describing the 
  junction read counts. The following fields are included in the tab-delimited
  output file.

  +------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
  | Name             | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
  +==================+=============================================================================================================================================================================================================================================================================================================================================================================================================================================================+
  | junction         | Splice junction in the TCGA format "chrX:start:+,chrX:end,+". "start" and "end" are the 1-based position of the last mapped nucleotide before the skip and the first mapped nucleotide after the skip (i.e. the last base of the previous exon and the first base of the next exon). Note that in .bed output these coordinates will be different, see the .bed output section below. The "+" is currently hardcoded, though this may change in the future. |
  +------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
  | count            | Raw count of reads supporting the junction. During correction counts for ambiguous junctions can be combined, though obviously these additional reads will not be visible in the raw BAM file.                                                                                                                                                                                                                                                              |
  +------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
  | type             | either "known" (matching a reference junction) or "novel" (not observed in the reference junction collection).                                                                                                                                                                                                                                                                                                                                              | 
  +------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
  | genes            | gene symbols from the junction calling process. These still need work in the raw junction calling process, it's recommended to use the "annotated" output files instead which assign matching HUGO gene symbols based on the UCSC refGene table.                                                                                                                                                                                                            | 
  +------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
  | transcripts      | list of known transcript IDs matching the junction.                                                                                                                                                                                                                                                                                                                                                                                                         |                                 
  +------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
  | qc_flanking      | Count of supporting reads passing flanking sequence checks (junctions observed adjacent to read ends require 18+ nt of flanking sequence, otherwise 10+ nt).                                                                                                                                                                                                                                                                                                |
  +------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
  | qc_plus          | Count of supporting reads aligned to the + strand.                                                                                                                                                                                                                                                                                                                                                                                                          |
  +------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
  | qc_minus         | Count of supporting reads aligned to the - strand.                                                                                                                                                                                                                                                                                                                                                                                                          |
  +------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
  | qc_perfect_reads | Count of supporting reads with perfect alignments (no reference mismatches of quality 15+, indels, or soft clips).                                                                                                                                                                                                                                                                                                                                          |
  +------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
  | qc_clean_reads   | Count of supporting reads whose alignments are not perfect but which have a ratio of <= 5% of reference mismatches of quality 15+, indels, or soft clips relative to the count of aligned bases on both the left and right flanking sequence. Note: qc_clean_reads does NOT include qc_perfect_reads: to get a count of "perfect plus pretty good" reads the two values must be added together.                                                             |
  +------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

ProteinPaint Visualizations
---------------------------

* **Interactive fusion visualization**: The interactive fusion viewer is available as a
  file with the name :code:`Putative Fusions (SAMPLE.final_fusions)`. Click on this file
  and then follow the :ref:`pp-fusion-viewer` guide.
* **Interactive coverage visualization**: The interactive coverage viewer is available as a
  file with the name :code:`Coverage (SAMPLE)`. Click on this file
  and then follow the :ref:`pp-coverage-viewer` guide.
