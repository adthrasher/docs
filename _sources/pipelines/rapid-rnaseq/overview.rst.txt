.. _rapid-rnaseq-overview:

Overview
========

Inputs
------

+-------------------+------------+----------------------------------------------------------------------+-----------------------+
| Name              | Type       | Description                                                          | Example               |  
+===================+============+======================================================================+=======================+
| FastQ files       | Input file | Gzipped FastQ files generated by human transcriptome sequencing      | *.fastq.gz or *.fq.gz |
+-------------------+------------+----------------------------------------------------------------------+-----------------------+

Outputs
-------

The Rapid RNA-Seq pipeline produces the following outputs:

+------------------------------------+--------------------------------------------------+
| Name                               | Description                                      |
+====================================+==================================================+
| Predicted gene fusions (.txt)      | File containing putative gene fusions.           | 
+------------------------------------+--------------------------------------------------+
| Coverage file (.bw)                | bigWig file containing coverage information.     |
+------------------------------------+--------------------------------------------------+
| Splice junction read counts (.txt) | Read counts for the splice junction detected.    |
+------------------------------------+--------------------------------------------------+
| Interactive fusion visualization   | Fusion visualization produced by ProteinPaint.   |
+------------------------------------+--------------------------------------------------+
| Interactive coverage visualization | Coverage visualization produced by ProteinPaint. |
+------------------------------------+--------------------------------------------------+

Process
-------

Synopsis
++++++++

1. The raw sequence data is aligned to hg19 using standard STAR mapping.
2. A coverage bigWig (.bw) file is produced to allow the user to 
   assess sample quality across the genome.
3. Two gene fusion detection algorithms are run in parallel.

   * The **Fuzzion** (Rice et al. unpublished data) fusion detection algorithm is run to 
     provide high sensitivity for recurrent gene fusions.
   * The **RNAPEG** (Edmonson et al. unpublished data) splice junction read counting algorithm is
     run to quantify read counts for splice junctions. These splice junction
     read counts are then used by **Cicero** (Li et al. unpublished data) to detect
     putative gene fusions.
4. Custom visualizations for putative gene fusions and genome coverage are 
   produced by ProteinPaint.


Mapping
+++++++

We use the STAR aligner to rapidly map reads to the GRCh37 human reference
genome. [PMID: 23104886]. This step generally takes around one
hour to complete assuming approximately 55-75 million paired reads are supplied.

Coverage
++++++++

Internally developed scripts calculate the coverage of mapped reads genome wide.
The resulting bigWig file can be viewed in ProteinPaint or used for quality
control.

Splice junction read quantification
+++++++++++++++++++++++++++++++++++

We use our RNAPEG software to quantify reads spanning known and novel splice
junctions. RNAPEG also corrects improper mappings at splice junction boundaries
for more accurate definition of novel splice junctions. The resulting junctions
file can be viewed along with the coverage bigWig file to gain insights into
gene expression and splicing patterns 

Genome-wide fusion prediction
+++++++++++++++++++++++++++++

We developed an assembly-based algorithm CICERO (Clipped-reads Extended for RNA
Optimization) that is able to extend the read-length spanning fusion junctions
for detecting complex fusions. CICERO finds clipped reads and junction spanning
reads, assembles them into a contig and maps the contig back to the reference
genome. Mapped contigs are then annotated and filtered. Those with potential
genic effects including gene fusion, ITD, readthrough or circular RNA are
reported in the final_fusions.txt file. An interactive version of this file with
predictions sorted by quality can be inspected with the ProteinPaint
interactive fusion viewer.

An abstract describing CICERO was presented at ASHG, 2014:
http://www.ashg.org/2014meeting/abstracts/fulltext/f140120024.htm

Low stringency fusion gene "Hotpot" search
++++++++++++++++++++++++++++++++++++++++++

We have observed that certain fusions such as KIAA1549-BRAF in low-grade glioma
have apparently limited read support in the bam file — either due to low
expression or low tumor purity. In these cases, we use a secondary tool,
FUZZION, that performs fuzzy matching for known fusion gene junctions for every
read in the bam file (both mapped and unmapped). FUZZION can recover even a
single low quality read potentially supporting a known fusion gene junction. The
FUZZION output is a simple text file with read IDs and sequences supporting a
particular gene fusion. The fusion point is indicated with square brakets “[].”
